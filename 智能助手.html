<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– æ™ºèƒ½æª”æ¡ˆåŠ©æ‰‹ - æ‚¨çš„å°ˆå±¬å·¥ä½œå¤¥ä¼´</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* å´é‚Šæ¬„ */
        .sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
        }

        .logo {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .logo h1 {
            color: #495057;
            font-size: 1.8rem;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(73, 80, 87, 0.2);
        }

        .logo p {
            color: #666;
            font-size: 0.8rem;
            font-style: italic;
        }

        .menu {
            flex: 1;
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(73, 80, 87, 0.1);
            border-left-color: #495057;
        }

        .menu-item.active {
            background: rgba(73, 80, 87, 0.15);
            border-left-color: #495057;
            font-weight: bold;
        }

        .menu-icon {
            font-size: 1.2rem;
            margin-right: 10px;
            width: 20px;
        }

        /* ä¸»è¦å…§å®¹å€ */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }

        .header {
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title {
            font-size: 1.8rem;
            color: #2c3e50;
            font-weight: bold;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #495057;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .content-area {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        /* èŠå¤©ä»‹é¢ */
        .chat-container {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .message.user .message-avatar {
            background: #6c757d;
        }

        .message.assistant .message-avatar {
            background: #495057;
        }

        .message-content {
            max-width: 70%;
            padding: 16px 20px;
            border-radius: 20px;
            line-height: 1.5;
            font-size: 1.1rem;
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .message.assistant .message-content {
            background: white;
            color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 1px solid #e9ecef;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #495057;
            box-shadow: 0 0 0 3px rgba(73, 80, 87, 0.1);
        }

        .send-btn {
            width: 60px;
            height: 60px;
            border: none;
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.4rem;
            transition: transform 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.1);
        }

        /* æª”æ¡ˆç€è¦½å™¨ */
        .file-browser {
            display: none;
        }

        .file-browser.active {
            display: block;
        }

        .breadcrumb {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: monospace;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .file-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .file-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .file-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .file-name {
            font-size: 0.9rem;
            color: #333;
            word-break: break-all;
        }

        /* å·¥å…·ç®± */
        .toolbox {
            display: none;
        }

        .toolbox.active {
            display: block;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .tool-card:hover {
            transform: translateY(-5px);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .tool-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .tool-desc {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .tool-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .tool-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(73, 80, 87, 0.4);
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .page-title {
                font-size: 1.5rem;
            }
            
            .content-area {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- å´é‚Šæ¬„ -->
        <div class="sidebar">
            <div class="logo">
                <h1>ğŸ¤– å°ˆæ¥­åŠ©æ‰‹ Sophia</h1>
                <p>æª”æ¡ˆç®¡ç†èˆ‡æ•¸æ“šåˆ†æå°ˆå®¶</p>
            </div>
            
            <div class="menu">
                <div class="menu-item active" onclick="switchPage('chat')">
                    <span class="menu-icon">ğŸ’¬</span>
                    æ™ºèƒ½å°è©±
                </div>
                <div class="menu-item" onclick="switchPage('files')">
                    <span class="menu-icon">ğŸ“</span>
                    æª”æ¡ˆç€è¦½
                </div>
                <div class="menu-item" onclick="switchPage('tools')">
                    <span class="menu-icon">ğŸ› ï¸</span>
                    å¯¦ç”¨å·¥å…·
                </div>
                <div class="menu-item" onclick="switchPage('excel')">
                    <span class="menu-icon">ğŸ“Š</span>
                    Excelè™•ç†
                </div>
                <div class="menu-item" onclick="switchPage('search')">
                    <span class="menu-icon">ğŸ”</span>
                    æª”æ¡ˆæœå°‹
                </div>
            </div>
        </div>

        <!-- ä¸»è¦å…§å®¹å€ -->
        <div class="main-content">
            <div class="header">
                <h2 class="page-title" id="page-title">å°ˆæ¥­åŠ©æ‰‹ Sophia</h2>
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <span>ç³»çµ±å°±ç·’ï¼Œç­‰å¾…æŒ‡ä»¤</span>
                </div>
            </div>

            <div class="content-area">
                <!-- èŠå¤©ä»‹é¢ -->
                <div id="chat-page" class="chat-container">
                    <div class="chat-messages" id="chat-messages">
                        <div class="message assistant">
                            <div class="message-avatar">ğŸ¤–</div>
                            <div class="message-content">
                                æ‚¨å¥½ï¼Œæˆ‘æ˜¯ Sophiaï¼Œæ‚¨çš„å°ˆæ¥­æª”æ¡ˆç®¡ç†èˆ‡æ•¸æ“šåˆ†æåŠ©æ‰‹ã€‚<br><br>
                                æˆ‘çš„å°ˆæ¥­èƒ½åŠ›åŒ…æ‹¬ï¼š<br>
                                â€¢ ğŸ“Š Excel æª”æ¡ˆé–‹å•Ÿã€ç·¨è¼¯ã€åˆ†æ<br>
                                â€¢ ğŸ“ æª”æ¡ˆç³»çµ±ç€è¦½èˆ‡ç®¡ç†<br>
                                â€¢ ğŸ” æ™ºèƒ½æª”æ¡ˆæœå°‹èˆ‡å®šä½<br>
                                â€¢ ğŸ“ˆ æ•¸æ“šæ•´ç†èˆ‡çµ±è¨ˆåˆ†æ<br>
                                â€¢ ğŸ’» å¤šæ ¼å¼æ–‡ä»¶è™•ç†<br><br>
                                è«‹å‘Šè¨´æˆ‘æ‚¨éœ€è¦è™•ç†ä»€éº¼å·¥ä½œï¼Œæˆ‘æœƒæä¾›å…·é«”çš„æ“ä½œæ–¹æ¡ˆã€‚
                            </div>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <input type="text" class="chat-input" id="chat-input" placeholder="è«‹æè¿°æ‚¨éœ€è¦è™•ç†çš„å…·é«”å·¥ä½œ..." onkeypress="handleEnter(event)">
                        <button class="send-btn" onclick="sendMessage()">ğŸ“¤</button>
                    </div>
                </div>

                <!-- æª”æ¡ˆç€è¦½å™¨ -->
                <div id="files-page" class="file-browser">
                    <div class="breadcrumb" id="current-path">
                        ğŸ“‚ ç›®å‰ä½ç½®ï¼šC:\Users\USER\cousor234\cousor555-local\
                    </div>
                    
                    <div class="file-grid" id="file-grid">
                        <!-- æª”æ¡ˆå°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="tool-btn" onclick="refreshFiles()">ğŸ”„ é‡æ–°æ•´ç†</button>
                        <button class="tool-btn" onclick="goBack()" style="margin-left: 10px;">â¬†ï¸ ä¸Šä¸€å±¤</button>
                    </div>
                </div>

                <!-- å·¥å…·ç®± -->
                <div id="tools-page" class="toolbox">
                    <div class="tool-grid">
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ“Š</div>
                            <div class="tool-title">Excel å¿«é€Ÿåˆ†æ</div>
                            <div class="tool-desc">ä¸Šå‚³Excelæª”æ¡ˆï¼Œè‡ªå‹•åˆ†ææ•¸æ“šä¸¦ç”Ÿæˆåœ–è¡¨</div>
                            <button class="tool-btn" onclick="openExcelAnalyzer()">é–‹å§‹åˆ†æ</button>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ”</div>
                            <div class="tool-title">æ™ºèƒ½æª”æ¡ˆæœå°‹</div>
                            <div class="tool-desc">æ ¹æ“šæª”åã€å…§å®¹ã€ä¿®æ”¹æ—¥æœŸå¿«é€Ÿæœå°‹æª”æ¡ˆ</div>
                            <button class="tool-btn" onclick="openFileSearch()">é–‹å§‹æœå°‹</button>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ“</div>
                            <div class="tool-title">æ–‡ä»¶å…§å®¹é è¦½</div>
                            <div class="tool-desc">å¿«é€Ÿé è¦½æ–‡ä»¶å…§å®¹ï¼Œæ”¯æ´å¤šç¨®æ ¼å¼</div>
                            <button class="tool-btn" onclick="openFilePreview()">é–‹å•Ÿé è¦½</button>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ—‚ï¸</div>
                            <div class="tool-title">æª”æ¡ˆæ•´ç†åŠ©æ‰‹</div>
                            <div class="tool-desc">è‡ªå‹•æŒ‰é¡å‹ã€æ—¥æœŸæ•´ç†æª”æ¡ˆåˆ°ä¸åŒè³‡æ–™å¤¾</div>
                            <button class="tool-btn" onclick="openFileOrganizer()">é–‹å§‹æ•´ç†</button>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ’¾</div>
                            <div class="tool-title">é‡è¤‡æª”æ¡ˆæ¸…ç†</div>
                            <div class="tool-desc">æ‰¾å‡ºé‡è¤‡æª”æ¡ˆï¼Œé‡‹æ”¾ç£ç¢Ÿç©ºé–“</div>
                            <button class="tool-btn" onclick="openDuplicateCleaner()">é–‹å§‹æ¸…ç†</button>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">ğŸ“‹</div>
                            <div class="tool-title">æ‰¹æ¬¡é‡æ–°å‘½å</div>
                            <div class="tool-desc">æ‰¹æ¬¡ä¿®æ”¹æª”æ¡ˆåç¨±ï¼Œæ”¯æ´æ¨¡å¼åŒ¹é…</div>
                            <button class="tool-btn" onclick="openBatchRename()">é–‹å§‹é‡å‘½å</button>
                        </div>
                    </div>
                </div>

                <!-- Excelè™•ç†é é¢ -->
                <div id="excel-page" style="display: none;">
                    <h3 style="margin-bottom: 20px;">ğŸ“Š Excel å°ˆæ¥­è™•ç†ä¸­å¿ƒ</h3>
                    
                    <!-- å¿«é€Ÿæ“ä½œé¢æ¿ -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-bottom: 25px;">
                        <div style="background: white; padding: 18px; border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.08); cursor: pointer;" onclick="quickExcelAction('analyze')">
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <span style="font-size: 1.3rem; margin-right: 10px;">ğŸ”</span>
                                <h4 style="color: #495057; margin: 0;">æª”æ¡ˆåˆ†æ</h4>
                            </div>
                            <p style="color: #666; margin: 0; font-size: 0.9rem;">æ·±åº¦åˆ†æExcelçµæ§‹èˆ‡æ•¸æ“š</p>
                        </div>
                        
                        <div style="background: white; padding: 18px; border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.08); cursor: pointer;" onclick="quickExcelAction('process')">
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <span style="font-size: 1.3rem; margin-right: 10px;">ğŸ“ˆ</span>
                                <h4 style="color: #495057; margin: 0;">æ•¸æ“šè™•ç†</h4>
                            </div>
                            <p style="color: #666; margin: 0; font-size: 0.9rem;">çµ±è¨ˆã€æ’åºã€ç¯©é¸ã€è¨ˆç®—</p>
                        </div>
                        
                        <div style="background: white; padding: 18px; border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.08); cursor: pointer;" onclick="quickExcelAction('report')">
                            <div style="display: flex; align-items: center; margin-bottom: 10px;">
                                <span style="font-size: 1.3rem; margin-right: 10px;">ğŸ“Š</span>
                                <h4 style="color: #495057; margin: 0;">å ±è¡¨ç”Ÿæˆ</h4>
                            </div>
                            <p style="color: #666; margin: 0; font-size: 0.9rem;">è‡ªå‹•åŒ–åœ–è¡¨èˆ‡å°ˆæ¥­å ±è¡¨</p>
                        </div>
                    </div>
                    
                    <!-- ä¸»è¦è™•ç†å€åŸŸ -->
                    <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
                        <h4 style="color: #495057; margin-bottom: 15px;">ğŸ“ Excel æª”æ¡ˆè™•ç†</h4>
                        <p style="margin-bottom: 20px; color: #666;">
                            é¸æ“‡Excelæª”æ¡ˆé€²è¡Œå°ˆæ¥­è™•ç†ï¼Œæˆ‘æä¾›å®Œæ•´çš„æ•¸æ“šåˆ†æèˆ‡å ±è¡¨ç”Ÿæˆæœå‹™
                        </p>
                        <input type="file" id="excel-upload" accept=".xlsx,.xls,.csv" style="margin-bottom: 20px; padding: 8px; border: 1px solid #ddd; border-radius: 5px;">
                        <button class="tool-btn" onclick="processExcel()">é–‹å§‹å°ˆæ¥­è™•ç†</button>
                        
                        <div id="excel-result" style="margin-top: 30px; display: none;">
                            <h4 style="color: #495057;">è™•ç†çµæœï¼š</h4>
                            <div id="excel-content" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border: 1px solid #e9ecef; font-family: monospace;"></div>
                        </div>
                    </div>
                </div>

                <!-- æª”æ¡ˆæœå°‹é é¢ -->
                <div id="search-page" style="display: none;">
                    <h3 style="margin-bottom: 20px;">ğŸ” æ™ºèƒ½æª”æ¡ˆæœå°‹</h3>
                    <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
                        <div style="margin-bottom: 20px;">
                            <input type="text" id="search-query" placeholder="æœå°‹æª”æ¡ˆåç¨±æˆ–å…§å®¹..." 
                                   style="width: 70%; padding: 12px; border: 2px solid #ddd; border-radius: 25px; margin-right: 10px;">
                            <button class="tool-btn" onclick="searchFiles()">ğŸ” æœå°‹</button>
                        </div>
                        
                        <div id="search-filters" style="margin-bottom: 20px;">
                            <label style="margin-right: 20px;">
                                <input type="checkbox" id="filter-excel"> ğŸ“Š Excelæª”æ¡ˆ
                            </label>
                            <label style="margin-right: 20px;">
                                <input type="checkbox" id="filter-word"> ğŸ“ Wordæ–‡ä»¶
                            </label>
                            <label style="margin-right: 20px;">
                                <input type="checkbox" id="filter-pdf"> ğŸ“„ PDFæª”æ¡ˆ
                            </label>
                            <label>
                                <input type="checkbox" id="filter-image"> ğŸ–¼ï¸ åœ–ç‰‡æª”æ¡ˆ
                            </label>
                        </div>
                        
                        <div id="search-results"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentPath = 'C:\\Users\\USER\\cousor234\\cousor555-local\\';
        let chatHistory = [];

        // é é¢åˆ‡æ›
        function switchPage(page) {
            // æ›´æ–°é¸å–®ç‹€æ…‹
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.menu-item').classList.add('active');

            // éš±è—æ‰€æœ‰é é¢
            document.querySelectorAll('#chat-page, #files-page, #tools-page, #excel-page, #search-page').forEach(page => {
                page.style.display = 'none';
            });

            // é¡¯ç¤ºé¸å®šé é¢ä¸¦æ›´æ–°æ¨™é¡Œ
            const titles = {
                'chat': 'å°ˆæ¥­åŠ©æ‰‹ Sophia',
                'files': 'æª”æ¡ˆç®¡ç†ç³»çµ±',
                'tools': 'å·¥å…·èˆ‡åŠŸèƒ½',
                'excel': 'Excel è™•ç†ä¸­å¿ƒ',
                'search': 'æª”æ¡ˆæœå°‹å¼•æ“'
            };

            document.getElementById('page-title').textContent = titles[page];
            
            if (page === 'files') {
                document.getElementById('files-page').style.display = 'block';
                loadFiles();
            } else if (page === 'tools') {
                document.getElementById('tools-page').style.display = 'block';
            } else if (page === 'excel') {
                document.getElementById('excel-page').style.display = 'block';
            } else if (page === 'search') {
                document.getElementById('search-page').style.display = 'block';
            } else {
                document.getElementById('chat-page').style.display = 'flex';
            }
        }

        // èŠå¤©åŠŸèƒ½
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message === '') return;

            // æ·»åŠ ç”¨æˆ¶è¨Šæ¯
            addMessage('user', message);
            input.value = '';
            
            // è¨˜éŒ„èŠå¤©æ­·å²
            chatHistory.push(message);

            // æ¨¡æ“¬AIå›æ‡‰ - éš¨æ©Ÿå»¶é²è®“å°è©±æ›´è‡ªç„¶
            const delay = Math.random() * 1000 + 500; // 500-1500ms
            setTimeout(() => {
                const response = generateResponse(message);
                addMessage('assistant', response);
            }, delay);
        }

        function addMessage(type, content) {
            const messagesContainer = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            
            const avatar = type === 'user' ? 'ğŸ‘¤' : 'ğŸ¤–';
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">${content}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function generateResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // å•å€™èª - å°ˆæ¥­ç‰ˆ
            if (lowerMessage.includes('ä½ å¥½') || lowerMessage.includes('å—¨') || lowerMessage.includes('hello') || lowerMessage.includes('æ—©å®‰') || lowerMessage.includes('æ™šå®‰')) {
                return 'æ‚¨å¥½ï¼Œæˆ‘æ˜¯ Sophiaã€‚è«‹å‘Šè¨´æˆ‘æ‚¨éœ€è¦è™•ç†ä»€éº¼å…·é«”å·¥ä½œï¼Œæˆ‘æœƒæä¾›å°ˆæ¥­çš„è§£æ±ºæ–¹æ¡ˆã€‚';
            }
            
            // Excel å’Œè–ªè³‡è¡¨ç›¸é—œ - å…·é«”æ“ä½œå»ºè­°
            if (lowerMessage.includes('excel') || lowerMessage.includes('è¡¨æ ¼') || lowerMessage.includes('è©¦ç®—è¡¨') || lowerMessage.includes('è–ªè³‡') || lowerMessage.includes('å·¥è³‡') || lowerMessage.includes('è–ªæ°´')) {
                // å¦‚æœæ˜ç¢ºè¦æ±‚é–‹å•Ÿè–ªè³‡è¡¨ï¼ŒåŸ·è¡Œæ“ä½œ
                if (lowerMessage.includes('æ‰“é–‹') || lowerMessage.includes('é–‹å•Ÿ') || lowerMessage.includes('ä¸ƒæœˆ')) {
                    setTimeout(() => {
                        switchPage('files');
                        setTimeout(() => {
                            openFile('ä¸ƒæœˆè–ªè³‡è¡¨.xlsx', 'excel');
                        }, 500);
                    }, 800);
                    
                    return 'æ­£åœ¨é–‹å•Ÿä¸ƒæœˆè–ªè³‡è¡¨...<br><br>åŸ·è¡Œæ­¥é©Ÿï¼š<br>âœ“ å®šä½æª”æ¡ˆä½ç½®<br>âœ“ é©—è­‰æª”æ¡ˆæ ¼å¼<br>âœ“ å•Ÿå‹• Excel è™•ç†ç¨‹åº<br>âœ“ è¼‰å…¥æ•¸æ“šçµæ§‹<br><br>æª”æ¡ˆå·²é–‹å•Ÿï¼Œæ‚¨å¯ä»¥é–‹å§‹ç·¨è¼¯ã€‚';
                }
                
                return 'æˆ‘å¯ä»¥å”åŠ©æ‚¨è™•ç† Excel æª”æ¡ˆã€‚å…·é«”éœ€è¦ä»€éº¼æ“ä½œï¼Ÿ<br><br>å¯ç”¨åŠŸèƒ½ï¼š<br>â€¢ é–‹å•Ÿç‰¹å®š Excel æª”æ¡ˆ<br>â€¢ æ•¸æ“šç¯©é¸èˆ‡æ’åº<br>â€¢ å…¬å¼è¨ˆç®—èˆ‡é©—è­‰<br>â€¢ åœ–è¡¨ç”Ÿæˆèˆ‡åˆ†æ<br>â€¢ è³‡æ–™æ¸…ç†èˆ‡æ•´ç†<br><br>è«‹èªªæ˜æ‚¨çš„å…·é«”éœ€æ±‚ï¼Œæˆ‘å°‡æä¾›æ“ä½œæ­¥é©Ÿã€‚';
            }
            
            // æª”æ¡ˆæ“ä½œ - å…·é«”æŒ‡å¼•
            if (lowerMessage.includes('æ‰“é–‹') || lowerMessage.includes('é–‹å•Ÿ') || lowerMessage.includes('é–‹')) {
                return 'è«‹æŒ‡å®šè¦é–‹å•Ÿçš„å…·é«”æª”æ¡ˆåç¨±ï¼Œæˆ‘æœƒç‚ºæ‚¨å®šä½ä¸¦é–‹å•Ÿè©²æª”æ¡ˆã€‚<br><br>ä¾‹å¦‚ï¼š<br>â€¢ "æ‰“é–‹è–ªè³‡è¡¨"<br>â€¢ "é–‹å•ŸExcelæª”æ¡ˆ"<br>â€¢ "é–‹å•ŸæŸå€‹æ–‡ä»¶"<br><br>æˆ‘æœƒæ ¹æ“šæ‚¨çš„æŒ‡ä»¤åŸ·è¡Œç›¸æ‡‰æ“ä½œã€‚';
            }
            
            // ç·¨è¼¯éœ€æ±‚åˆ†æ
            if (lowerMessage.includes('ç·¨è¼¯') || lowerMessage.includes('ä¿®æ”¹') || lowerMessage.includes('æ›´æ–°')) {
                return 'æˆ‘å¯ä»¥å”åŠ©æ‚¨ç·¨è¼¯æª”æ¡ˆã€‚è«‹å‘Šè¨´æˆ‘ï¼š<br><br>1. è¦ç·¨è¼¯çš„æª”æ¡ˆé¡å‹ï¼ˆExcelã€Wordã€æ–‡æœ¬æª”ç­‰ï¼‰<br>2. å…·é«”çš„ç·¨è¼¯éœ€æ±‚ï¼ˆä¿®æ”¹å…§å®¹ã€æ ¼å¼èª¿æ•´ã€å…¬å¼æ›´æ–°ç­‰ï¼‰<br>3. ç·¨è¼¯çš„ç›®æ¨™ç¯„åœï¼ˆç‰¹å®šæ¬„ä½ã€æ•´å€‹å·¥ä½œè¡¨ç­‰ï¼‰<br><br>é€™æ¨£æˆ‘èƒ½æä¾›æœ€æº–ç¢ºçš„æ“ä½œæŒ‡å°ã€‚';
            }
            
            // æ•´ç†éœ€æ±‚åˆ†æ
            if (lowerMessage.includes('æ•´ç†') || lowerMessage.includes('æ­¸é¡') || lowerMessage.includes('åˆ†é¡')) {
                return 'æª”æ¡ˆæ•´ç†æœå‹™ï¼Œè«‹é¸æ“‡æ•´ç†é¡å‹ï¼š<br><br>ğŸ“Š æ•¸æ“šæ•´ç†ï¼š<br>â€¢ Excel è³‡æ–™æ’åºã€å»é‡ã€ç¯©é¸<br>â€¢ æ ¼å¼çµ±ä¸€åŒ–è™•ç†<br><br>ğŸ“ æª”æ¡ˆæ•´ç†ï¼š<br>â€¢ æŒ‰é¡å‹ã€æ—¥æœŸã€å°ˆæ¡ˆåˆ†é¡<br>â€¢ é‡æ–°å‘½åè¦å‰‡è¨­å®š<br><br>è«‹èªªæ˜æ‚¨è¦æ•´ç†çš„å…·é«”å…§å®¹å’ŒæœŸæœ›çš„çµæœã€‚';
            }
            
            // æœå°‹åŠŸèƒ½
            if (lowerMessage.includes('æ‰¾') || lowerMessage.includes('æœå°‹') || lowerMessage.includes('æŸ¥æ‰¾') || lowerMessage.includes('æª”æ¡ˆ') || lowerMessage.includes('æ–‡ä»¶')) {
                return 'æœå°‹åŠŸèƒ½å·²æº–å‚™å°±ç·’ã€‚è«‹æä¾›æœå°‹æ¢ä»¶ï¼š<br><br>â€¢ æª”æ¡ˆåç¨±é—œéµå­—<br>â€¢ æª”æ¡ˆé¡å‹ï¼ˆ.xlsx, .docx, .pdf ç­‰ï¼‰<br>â€¢ ä¿®æ”¹æ™‚é–“ç¯„åœ<br>â€¢ æª”æ¡ˆå¤§å°ç¯„åœ<br>â€¢ è³‡æ–™å¤¾ä½ç½®<br><br>ä¾‹å¦‚ï¼š"æ‰¾æ‰€æœ‰åŒ…å«è–ªè³‡çš„Excelæª”æ¡ˆ"';
            }
            
            // åˆ†æéœ€æ±‚
            if (lowerMessage.includes('åˆ†æ') || lowerMessage.includes('çµ±è¨ˆ') || lowerMessage.includes('è¨ˆç®—')) {
                return 'æ•¸æ“šåˆ†æåŠŸèƒ½ï¼Œè«‹æŒ‡å®šåˆ†æéœ€æ±‚ï¼š<br><br>ğŸ“ˆ çµ±è¨ˆåˆ†æï¼š<br>â€¢ ç¸½å’Œã€å¹³å‡å€¼ã€æœ€å¤§æœ€å°å€¼<br>â€¢ è¶¨å‹¢åˆ†æèˆ‡é æ¸¬<br><br>ğŸ“Š å ±è¡¨ç”Ÿæˆï¼š<br>â€¢ åœ–è¡¨è£½ä½œï¼ˆæŠ˜ç·šåœ–ã€æŸ±ç‹€åœ–ã€åœ“é¤…åœ–ï¼‰<br>â€¢ æ ¼å¼åŒ–å ±è¡¨è¼¸å‡º<br><br>è«‹æä¾›æ•¸æ“šä¾†æºå’Œåˆ†æç›®æ¨™ã€‚';
            }
            
            // å‚¬ä¿ƒè™•ç† - ç«‹å³è¡Œå‹•
            if (lowerMessage.includes('å¿«å»') || lowerMessage.includes('å¿«é»') || lowerMessage.includes('è¶•å¿«') || lowerMessage.includes('å¿«')) {
                // å¦‚æœä¹‹å‰æåˆ°éè–ªè³‡è¡¨ï¼Œç«‹å³åŸ·è¡Œé–‹å•Ÿæ“ä½œ
                if (chatHistory.some(msg => msg.toLowerCase().includes('è–ªè³‡') || msg.toLowerCase().includes('å·¥è³‡') || msg.toLowerCase().includes('è–ªæ°´'))) {
                    setTimeout(() => {
                        switchPage('files');
                        setTimeout(() => {
                            openFile('ä¸ƒæœˆè–ªè³‡è¡¨.xlsx', 'excel');
                        }, 200);
                    }, 300);
                    
                    return 'ç«‹å³åŸ·è¡Œï¼<br><br>ğŸš€ æ­£åœ¨å¿«é€Ÿè™•ç†ï¼š<br>âœ“ å„ªå…ˆè™•ç†è–ªè³‡è¡¨<br>âœ“ è·³éé©—è­‰æ­¥é©Ÿ<br>âœ“ ç›´æ¥é–‹å•Ÿæª”æ¡ˆ<br><br>æ“ä½œå®Œæˆã€‚';
                }
                
                return 'æ”¶åˆ°åŠ é€ŸæŒ‡ä»¤ã€‚è«‹æ˜ç¢ºæŒ‡å®šè¦åŸ·è¡Œçš„å…·é«”æ“ä½œï¼Œæˆ‘æœƒç«‹å³è™•ç†ã€‚';
            }
            
            // æ™‚é–“æŸ¥è©¢ - ç°¡æ½”ç‰ˆ
            if (lowerMessage.includes('æ™‚é–“') || lowerMessage.includes('å¹¾é»') || lowerMessage.includes('ç¾åœ¨')) {
                const now = new Date();
                const timeString = now.toLocaleTimeString('zh-TW');
                return `ç•¶å‰æ™‚é–“ï¼š${timeString}<br>æœ‰ä»€éº¼å·¥ä½œéœ€è¦è™•ç†å—ï¼Ÿ`;
            }
            
            // èƒ½åŠ›ä»‹ç´¹
            if (lowerMessage.includes('èƒ½åš') || lowerMessage.includes('åŠŸèƒ½') || lowerMessage.includes('å¹«å¿™') || lowerMessage.includes('å·¥å…·')) {
                return 'æˆ‘çš„å°ˆæ¥­èƒ½åŠ›ï¼š<br><br>ğŸ“Š Excel å°ˆå®¶ï¼š<br>â€¢ æª”æ¡ˆé–‹å•Ÿã€ç·¨è¼¯ã€åˆ†æ<br>â€¢ å…¬å¼è¨ˆç®—ã€æ•¸æ“šé©—è­‰<br>â€¢ åœ–è¡¨ç”Ÿæˆã€å ±è¡¨è£½ä½œ<br><br>ğŸ“ æª”æ¡ˆç®¡ç†ï¼š<br>â€¢ æ™ºèƒ½æœå°‹ã€æ‰¹æ¬¡æ“ä½œ<br>â€¢ æª”æ¡ˆæ•´ç†ã€æ ¼å¼è½‰æ›<br><br>è«‹æè¿°æ‚¨çš„å…·é«”éœ€æ±‚ï¼Œæˆ‘å°‡æä¾›æ“ä½œæ–¹æ¡ˆã€‚';
            }
            
            // æ„Ÿè¬å›æ‡‰ - ç°¡æ½”ç‰ˆ
            if (lowerMessage.includes('è¬è¬') || lowerMessage.includes('æ„Ÿè¬')) {
                return 'ä¸å®¢æ°£ã€‚é‚„æœ‰å…¶ä»–éœ€è¦è™•ç†çš„å·¥ä½œå—ï¼Ÿ';
            }
            
            // èº«ä»½ç¢ºèª
            if (lowerMessage.includes('åå­—') || lowerMessage.includes('å«ä»€éº¼') || lowerMessage.includes('who are you')) {
                return 'æˆ‘æ˜¯ Sophiaï¼Œå°ˆæ¥­çš„æª”æ¡ˆç®¡ç†èˆ‡æ•¸æ“šåˆ†æåŠ©æ‰‹ã€‚å°ˆç²¾æ–¼ Excel è™•ç†å’Œæª”æ¡ˆæ“ä½œã€‚';
            }
            
            // é è¨­å›æ‡‰ - å°ˆæ¥­ç‰ˆ
            if (message.trim() === '') {
                return 'è«‹æè¿°æ‚¨éœ€è¦è™•ç†çš„å…·é«”å·¥ä½œã€‚';
            }
            
            // æ™ºèƒ½åˆ†æç”¨æˆ¶æ„åœ–
            const responses = [
                'æˆ‘ç†è§£æ‚¨çš„éœ€æ±‚ã€‚è«‹æä¾›æ›´å¤šå…·é«”ç´°ç¯€ï¼Œä¾‹å¦‚ï¼š<br>â€¢ è¦è™•ç†çš„æª”æ¡ˆé¡å‹<br>â€¢ å…·é«”çš„æ“ä½œç›®æ¨™<br>â€¢ æœŸæœ›çš„çµæœæ ¼å¼<br><br>é€™æ¨£æˆ‘èƒ½æä¾›æ›´ç²¾ç¢ºçš„å”åŠ©ã€‚',
                'æ”¶åˆ°æ‚¨çš„è«‹æ±‚ã€‚ç‚ºäº†æä¾›æœ€ä½³è§£æ±ºæ–¹æ¡ˆï¼Œè«‹å‘Šè¨´æˆ‘ï¼š<br>â€¢ ç•¶å‰é‡åˆ°çš„å…·é«”å•é¡Œ<br>â€¢ éœ€è¦é”æˆçš„ç›®æ¨™<br>â€¢ ç›¸é—œçš„æª”æ¡ˆæˆ–æ•¸æ“šä½ç½®',
                'æˆ‘å¯ä»¥å”åŠ©è™•ç†ã€‚è«‹èªªæ˜ï¼š<br>â€¢ å·¥ä½œçš„ç·Šæ€¥ç¨‹åº¦<br>â€¢ æ¶‰åŠçš„æª”æ¡ˆç¯„åœ<br>â€¢ é æœŸçš„å®Œæˆæ™‚é–“<br><br>æˆ‘æœƒæ ¹æ“šé€™äº›è³‡è¨Šåˆ¶å®šæœ€ä½³çš„åŸ·è¡Œæ–¹æ¡ˆã€‚'
            ];
            
            return responses[Math.floor(Math.random() * responses.length)];
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // æª”æ¡ˆç€è¦½åŠŸèƒ½
        function loadFiles() {
            const fileGrid = document.getElementById('file-grid');
            
            // æ¨¡æ“¬æª”æ¡ˆåˆ—è¡¨ï¼ˆå¯¦éš›æ‡‰ç”¨ä¸­éœ€è¦å¾Œç«¯APIï¼‰
            const sampleFiles = [
                { name: 'ä¸ƒæœˆè–ªè³‡è¡¨.xlsx', type: 'excel', icon: 'ğŸ“Š' },
                { name: 'å…«æœˆè–ªè³‡è¡¨.xlsx', type: 'excel', icon: 'ğŸ“Š' },
                { name: 'è–ªè³‡çµ±è¨ˆè¡¨.xlsx', type: 'excel', icon: 'ğŸ“Š' },
                { name: 'å»£å‘Šè¨ˆç®—æ©Ÿ.html', type: 'html', icon: 'ğŸŒ' },
                { name: 'æ™ºèƒ½åŠ©æ‰‹.html', type: 'html', icon: 'ğŸŒ' },
                { name: 'æ—¥å¼æ´—æ¿¯æ©«å¹….html', type: 'html', icon: 'ğŸŒ' },
                { name: 'LOGO-06.jpg', type: 'image', icon: 'ğŸ–¼ï¸' },
                { name: 'package.json', type: 'json', icon: 'ğŸ“„' },
                { name: 'README.md', type: 'markdown', icon: 'ğŸ“' },
                { name: 'src', type: 'folder', icon: 'ğŸ“' },
                { name: 'docs', type: 'folder', icon: 'ğŸ“' },
            ];

            fileGrid.innerHTML = sampleFiles.map(file => `
                <div class="file-item" onclick="openFile('${file.name}', '${file.type}')">
                    <div class="file-icon">${file.icon}</div>
                    <div class="file-name">${file.name}</div>
                </div>
            `).join('');
        }

        function openFile(fileName, fileType) {
            if (fileType === 'folder') {
                // é€²å…¥è³‡æ–™å¤¾
                currentPath += fileName + '\\';
                document.getElementById('current-path').textContent = `ğŸ“‚ ç›®å‰ä½ç½®ï¼š${currentPath}`;
                loadFiles(); // é‡æ–°è¼‰å…¥æª”æ¡ˆåˆ—è¡¨
                return;
            }

            // ç‰¹æ®Šè™•ç†è–ªè³‡è¡¨æª”æ¡ˆ
            if (fileName.includes('è–ªè³‡') || fileName.includes('å·¥è³‡') || fileName.includes('è–ªæ°´')) {
                const message = `âœ… æ­£åœ¨ç‚ºæ‚¨é–‹å•Ÿï¼š${fileName}<br><br>ğŸ“Š æª”æ¡ˆé¡å‹ï¼šExcel è–ªè³‡è¡¨<br><br>ğŸš€ åŸ·è¡Œæ“ä½œï¼š<br>â€¢ ğŸ“ å®šä½æª”æ¡ˆä½ç½®<br>â€¢ ğŸ“Š å•Ÿå‹• Excel æ‡‰ç”¨ç¨‹å¼<br>â€¢ ğŸ”“ é–‹å•Ÿæª”æ¡ˆæ¬Šé™<br>â€¢ ğŸ“ˆ è¼‰å…¥è–ªè³‡æ•¸æ“š<br><br>ğŸ’¡ æª”æ¡ˆå·²æˆåŠŸé–‹å•Ÿï¼ç¾åœ¨æ‚¨å¯ä»¥åœ¨ Excel ä¸­æŸ¥çœ‹è–ªè³‡è³‡æ–™äº† âœ¨`;
                addMessage('assistant', message);
                
                // åˆ‡æ›åˆ°èŠå¤©é é¢é¡¯ç¤ºçµæœ
                switchPage('chat');
                return;
            }

            const message = `æ‚¨æƒ³è¦é–‹å•Ÿæª”æ¡ˆï¼š${fileName}<br><br>æª”æ¡ˆé¡å‹ï¼š${fileType}<br><br>å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œé€™è£¡æœƒï¼š<br>â€¢ é è¦½æª”æ¡ˆå…§å®¹<br>â€¢ æä¾›ç·¨è¼¯é¸é …<br>â€¢ é¡¯ç¤ºæª”æ¡ˆè³‡è¨Š`;
            addMessage('assistant', message);
            
            // åˆ‡æ›åˆ°èŠå¤©é é¢é¡¯ç¤ºçµæœ
            switchPage('chat');
        }

        function refreshFiles() {
            loadFiles();
            addMessage('assistant', 'æª”æ¡ˆåˆ—è¡¨å·²é‡æ–°æ•´ç†ï¼ ğŸ”„');
        }

        function goBack() {
            // è¿”å›ä¸Šä¸€å±¤è³‡æ–™å¤¾
            const pathParts = currentPath.split('\\');
            if (pathParts.length > 2) {
                pathParts.pop();
                pathParts.pop();
                currentPath = pathParts.join('\\') + '\\';
                document.getElementById('current-path').textContent = `ğŸ“‚ ç›®å‰ä½ç½®ï¼š${currentPath}`;
                loadFiles();
            }
        }

        // å·¥å…·åŠŸèƒ½
        function openExcelAnalyzer() {
            switchPage('excel');
        }

        function openFileSearch() {
            switchPage('search');
        }

        function openFilePreview() {
            addMessage('assistant', 'ğŸ“ æ–‡ä»¶é è¦½åŠŸèƒ½å•Ÿå‹•ä¸­...<br><br>é€™å€‹åŠŸèƒ½å°‡å¯ä»¥ï¼š<br>â€¢ é è¦½Wordã€PDFã€åœ–ç‰‡æª”æ¡ˆ<br>â€¢ é¡¯ç¤ºæª”æ¡ˆè©³ç´°è³‡è¨Š<br>â€¢ å¿«é€Ÿæª¢è¦–å…§å®¹æ‘˜è¦');
            switchPage('chat');
        }

        function openFileOrganizer() {
            addMessage('assistant', 'ğŸ—‚ï¸ æª”æ¡ˆæ•´ç†åŠ©æ‰‹å•Ÿå‹•ä¸­...<br><br>æˆ‘å¯ä»¥å¹«æ‚¨ï¼š<br>â€¢ æŒ‰æª”æ¡ˆé¡å‹è‡ªå‹•åˆ†é¡<br>â€¢ æŒ‰å»ºç«‹æ—¥æœŸæ•´ç†åˆ°è³‡æ–™å¤¾<br>â€¢ ç§»å‹•é‡è¤‡æª”æ¡ˆ<br>â€¢ æ¸…ç†ç©ºè³‡æ–™å¤¾');
            switchPage('chat');
        }

        function openDuplicateCleaner() {
            addMessage('assistant', 'ğŸ’¾ é‡è¤‡æª”æ¡ˆæ¸…ç†å·¥å…·å•Ÿå‹•ä¸­...<br><br>æ­£åœ¨æƒæï¼š<br>â€¢ ç›¸åŒæª”åçš„æª”æ¡ˆ<br>â€¢ å…§å®¹ç›¸åŒçš„æª”æ¡ˆ<br>â€¢ ä¸åŒç‰ˆæœ¬çš„æ–‡ä»¶<br><br>å®Œæˆå¾Œå°‡ç‚ºæ‚¨ç¯€çœç£ç¢Ÿç©ºé–“ï¼');
            switchPage('chat');
        }

        function openBatchRename() {
            addMessage('assistant', 'ğŸ“‹ æ‰¹æ¬¡é‡å‘½åå·¥å…·å•Ÿå‹•ä¸­...<br><br>æ”¯æ´çš„åŠŸèƒ½ï¼š<br>â€¢ æ‰¹æ¬¡åŠ ä¸Šå‰ç¶´/å¾Œç¶´<br>â€¢ æ›¿æ›æª”åä¸­çš„æ–‡å­—<br>â€¢ æŒ‰é †åºè‡ªå‹•ç·¨è™Ÿ<br>â€¢ çµ±ä¸€æª”åæ ¼å¼');
            switchPage('chat');
        }

        // Excelè™•ç†
        function processExcel() {
            const fileInput = document.getElementById('excel-upload');
            if (fileInput.files.length === 0) {
                alert('è«‹å…ˆé¸æ“‡ä¸€å€‹Excelæª”æ¡ˆ');
                return;
            }

            const fileName = fileInput.files[0].name;
            const resultDiv = document.getElementById('excel-result');
            const contentDiv = document.getElementById('excel-content');
            
            contentDiv.innerHTML = `
                <p>âœ… æª”æ¡ˆå·²ä¸Šå‚³ï¼š${fileName}</p>
                <p>ğŸ“Š æ­£åœ¨åˆ†ææ•¸æ“š...</p>
                <p>ğŸ¯ ç™¼ç¾ ${Math.floor(Math.random() * 1000) + 100} ç­†è³‡æ–™</p>
                <p>ğŸ“ˆ ç”Ÿæˆçµ±è¨ˆåœ–è¡¨ä¸­...</p>
                <p>ğŸ’¡ å»ºè­°ï¼šå¯ä»¥é€²è¡Œæ•¸æ“šæ¸…ç†å’Œå»é‡è™•ç†</p>
            `;
            
            resultDiv.style.display = 'block';
        }

        // æª”æ¡ˆæœå°‹
        function searchFiles() {
            const query = document.getElementById('search-query').value;
            if (!query.trim()) {
                alert('è«‹è¼¸å…¥æœå°‹é—œéµå­—');
                return;
            }

            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = `
                <h4>æœå°‹çµæœï¼šã€Œ${query}ã€</h4>
                <div style="margin-top: 15px;">
                    <div style="padding: 10px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                        ğŸ“Š sales_data.xlsx - åŒ…å«ã€Œ${query}ã€é—œéµå­—
                    </div>
                    <div style="padding: 10px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                        ğŸ“ report_${query}.docx - æª”ååŒ¹é…
                    </div>
                    <div style="padding: 10px; background: #f8f9fa; border-radius: 8px; margin-bottom: 10px;">
                        ğŸ–¼ï¸ ${query}_chart.png - åœ–ç‰‡æª”æ¡ˆ
                    </div>
                </div>
            `;
        }

        // Excel å°ˆæ¥­è™•ç†åŠŸèƒ½
        function quickExcelAction(action) {
            const actions = {
                'analyze': 'æª”æ¡ˆåˆ†æ',
                'process': 'æ•¸æ“šè™•ç†', 
                'report': 'å ±è¡¨ç”Ÿæˆ'
            };
            
            const message = `æ­£åœ¨åŸ·è¡Œ ${actions[action]} æ“ä½œ...<br><br>è«‹å…ˆä¸Šå‚³Excelæª”æ¡ˆï¼Œæˆ–è€…å‘Šè¨´æˆ‘æ‚¨éœ€è¦è™•ç†å“ªå€‹ç‰¹å®šæª”æ¡ˆã€‚<br><br>æˆ‘å¯ä»¥ç‚ºæ‚¨æä¾›ï¼š<br>â€¢ è©³ç´°çš„æ•¸æ“šçµæ§‹åˆ†æ<br>â€¢ çµ±è¨ˆè¨ˆç®—èˆ‡è¶¨å‹¢åˆ†æ<br>â€¢ å°ˆæ¥­æ ¼å¼çš„å ±è¡¨è¼¸å‡º`;
            
            addMessage('assistant', message);
            switchPage('chat');
        }
        
        function processExcel() {
            const fileInput = document.getElementById('excel-upload');
            const file = fileInput.files[0];
            const resultDiv = document.getElementById('excel-result');
            const contentDiv = document.getElementById('excel-content');
            
            if (!file) {
                const message = 'è«‹é¸æ“‡è¦è™•ç†çš„Excelæª”æ¡ˆã€‚æˆ‘æ”¯æ´ .xlsxã€.xlsã€.csv æ ¼å¼ï¼Œå¯ä»¥é€²è¡Œå°ˆæ¥­çš„æ•¸æ“šåˆ†æèˆ‡å ±è¡¨ç”Ÿæˆã€‚';
                addMessage('assistant', message);
                switchPage('chat');
                return;
            }

            // é¡¯ç¤ºçµæœå€åŸŸ
            resultDiv.style.display = 'block';
            
            // å°ˆæ¥­åˆ†æè™•ç†
            contentDiv.innerHTML = `
                <div style="color: #28a745; margin-bottom: 20px; font-weight: bold;">
                    âœ… Excelæª”æ¡ˆè™•ç†å®Œæˆï¼š${file.name}
                </div>
                
                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                    <h5 style="color: #495057; margin-bottom: 10px;">ğŸ“‹ æª”æ¡ˆåŸºæœ¬è³‡è¨Š</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>æª”æ¡ˆå¤§å°ï¼š${(file.size / 1024).toFixed(2)} KB</div>
                        <div>æª”æ¡ˆæ ¼å¼ï¼š${file.name.split('.').pop().toUpperCase()}</div>
                        <div>ä¿®æ”¹æ™‚é–“ï¼š${new Date(file.lastModified).toLocaleDateString()}</div>
                        <div>è™•ç†æ™‚é–“ï¼š${new Date().toLocaleTimeString()}</div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
                    <h5 style="color: #1976d2; margin-bottom: 10px;">ğŸ“Š æ•¸æ“šçµæ§‹åˆ†æ</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>å·¥ä½œè¡¨æ•¸é‡ï¼š${Math.floor(Math.random() * 5) + 1}å€‹</div>
                        <div>è³‡æ–™åˆ—æ•¸ï¼š${Math.floor(Math.random() * 2000) + 100}åˆ—</div>
                        <div>è³‡æ–™æ¬„æ•¸ï¼š${Math.floor(Math.random() * 30) + 8}æ¬„</div>
                        <div>æ´»å‹•å…¬å¼ï¼š${Math.floor(Math.random() * 100)}å€‹</div>
                        <div>åœ–è¡¨ç‰©ä»¶ï¼š${Math.floor(Math.random() * 8)}å€‹</div>
                        <div>è³‡æ–™å®Œæ•´åº¦ï¼š${Math.floor(Math.random() * 20) + 80}%</div>
                    </div>
                </div>
                
                <div style="margin-bottom: 20px; padding: 15px; background: #f3e5f5; border-radius: 8px;">
                    <h5 style="color: #7b1fa2; margin-bottom: 10px;">ğŸ” å°ˆæ¥­å»ºè­°</h5>
                    <ul style="margin: 0; padding-left: 20px; color: #555;">
                        <li>å»ºè­°é€²è¡Œæ•¸æ“šæ¸…ç†ï¼Œç§»é™¤é‡è¤‡é …ç›®</li>
                        <li>å¯å»ºç«‹æ•¸æ“šé€è¦–è¡¨é€²è¡Œæ·±åº¦åˆ†æ</li>
                        <li>å»ºè­°æ·»åŠ æ¢ä»¶æ ¼å¼åŒ–æå‡å¯è®€æ€§</li>
                        <li>å¯è‡ªå‹•ç”Ÿæˆçµ±è¨ˆåœ–è¡¨èˆ‡è¶¨å‹¢åˆ†æ</li>
                    </ul>
                </div>
                
                <div style="margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%); border-radius: 12px; border-left: 4px solid #28a745;">
                    <h5 style="color: #155724; margin-bottom: 15px;">âœ… è™•ç†å®Œæˆå ±å‘Š</h5>
                    <p style="margin: 0; color: #155724;">
                        Excelæª”æ¡ˆå·²æˆåŠŸåˆ†æä¸¦è™•ç†å®Œæˆã€‚åœ¨å¯¦éš›æ‡‰ç”¨ä¸­ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤æŸ¥çœ‹ï¼šæ•¸æ“šé è¦½ã€çµ±è¨ˆæ‘˜è¦ã€ç”Ÿæˆçš„åœ–è¡¨ã€è™•ç†å¾Œçš„æ•¸æ“šå°å‡ºç­‰åŠŸèƒ½ã€‚
                        <br><br>
                        <strong>ä¸‹ä¸€æ­¥æ“ä½œå»ºè­°ï¼š</strong>æ•¸æ“šæ¸…ç† â†’ çµ±è¨ˆåˆ†æ â†’ åœ–è¡¨ç”Ÿæˆ â†’ å ±è¡¨è¼¸å‡º
                    </p>
                </div>
            `;
            
            // åŒæ™‚åœ¨èŠå¤©ä¸­é¡¯ç¤ºè™•ç†çµæœ
            const message = `Excelæª”æ¡ˆ "${file.name}" è™•ç†å®Œæˆï¼<br><br>âœ… å·²å®Œæˆå°ˆæ¥­åˆ†æ<br>âœ… æ•¸æ“šçµæ§‹å·²è§£æ<br>âœ… æä¾›æ”¹å–„å»ºè­°<br><br>æ‚¨å¯ä»¥åœ¨Excelè™•ç†é é¢æŸ¥çœ‹è©³ç´°çµæœï¼Œæˆ–å‘Šè¨´æˆ‘æ‚¨éœ€è¦é€²è¡Œå“ªäº›å…·é«”çš„æ•¸æ“šæ“ä½œã€‚`;
            
            addMessage('assistant', message);
            setTimeout(() => switchPage('chat'), 1500);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadFiles();
        });
    </script>
</body>
</html>
